#!/bin/env pypenv
# -*- Mode: Python; tab-width: 4; py-indent-offset: 4; -*-
#
# this is b8stim.py; Two stimuli are presented per presentation;
# so there are four arrays for the two Xs and Ys respectively.
# stimulus rotation is done at the sprite end

 
from Numeric import *
from random import *

numstims = 35
pre_rots = arange(360)
rots = pre_rots[::45]

# Stimuli are created for an RF dia of 100
spritesize = 100
nvrt =[16,20,24,24,28,18,20,12,16,16,16,20,20,20,24,16,16,16,20,20,20,16,14,18,16,20,18,22,14,12,12,14,14,12,18]                               #number of vertices for each object
stm2=[24,29]
rot2=list(rots[0:2])*len(stm2)
rot2.sort()
stm4=[1,3,26]
rot4=list(rots[0:4])*len(stm4)
rot4.sort()
stm8=[2]+list(arange(4,24))+[25,27,28]+list(arange(30,37))
rot8=list(rots)*len(stm8)
rot8.sort()
stmlist = stm2*2+stm4*4+stm8*8
rotlist = rot2+rot4+rot8
#this is for subset stimuli 1-29
sub_stm8 =[2]+list(arange(4,24))+[25,27,28]
sub_rot8=list(rots)*len(sub_stm8)
sub_rot8.sort()
sub_stmlist = stm2*2+stm4*4+sub_stm8*8
sub_rotlist = rot2+rot4+sub_rot8

Xvrt = zeros((numstims, max(nvrt)+3), Float) #this is from vertices2.txt
Yvrt = zeros((numstims, max(nvrt)+3), Float)

Xvrt[0,0:nvrt[0]+3]=asarray([-1.6,-0.988,-0.468,-0.122,0.0,0.122,0.468,0.988,1.6,0.988,0.468,0.122,0.0,-0.122,-0.468,-0.988,-1.6,-0.988,-0.468])*25.0
Yvrt[0,0:nvrt[0]+3]=asarray([0.0,0.122,0.468,0.988,1.6,0.988,0.468,0.122,0.0,-0.122,-0.468,-0.988,-1.6,-0.988,-0.468,-0.122,0.0,0.122,0.468])*25.0

Xvrt[1,0:nvrt[1]+3]=asarray([-1.6,-0.988,-0.468,-0.122,0.0,0.122,0.468,0.988,1.6,1.14,0.751,0.5,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-0.988,-0.468])*25.0
Yvrt[1,0:nvrt[1]+3]=asarray([0.0,0.122,0.468,0.988,1.6,0.988,0.468,0.122,0.0,-0.1,-0.351,-0.74,-1.2,-1.483,-1.6,-1.483,-1.2,-0.74,-0.351,-0.1,0.0,0.122,0.468])*25.0

Xvrt[2,0:nvrt[2]+3]=asarray([-1.6,-1.483,-1.2,-0.74,-0.351,-0.1,0.0,0.1,0.351,0.74,1.2,1.483,1.6,1.483,1.2,0.74,0.351,0.1,0.0,-0.1,-0.351,-0.74,-1.2,-1.483,-1.6,-1.483,-1.2])*25.0
Yvrt[2,0:nvrt[2]+3]=asarray([0.0,0.283,0.4,0.5,0.751,1.14,1.6,1.14,0.751,0.5,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-1.14,-0.751,-0.5,-0.4,-0.283,0.0,0.283,0.4])*25.0

Xvrt[3,0:nvrt[3]+3]=asarray([-1.6,-0.988,-0.468,-0.122,0.0,0.1,0.351,0.74,1.2,1.483,1.6,1.483,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-0.988,-0.468])*25.0
Yvrt[3,0:nvrt[3]+3]=asarray([0.0,0.122,0.468,0.988,1.6,1.14,0.751,0.5,0.4,0.283,0.0,-0.283,-0.4,-0.461,-0.635,-0.894,-1.2,-1.483,-1.6,-1.483,-1.2,-0.74,-0.351,-0.1,0.0,0.122,0.468])*25.0

Xvrt[4,0:nvrt[4]+3]=asarray([-1.6,-1.483,-1.2,-0.894,-0.635,-0.461,-0.4,-0.283,0.0,0.283,0.4,0.461,0.635,0.894,1.2,1.483,1.6,1.483,1.2,0.74,0.351,0.1,0.0,-0.1,-0.351,-0.74,-1.2,-1.483,-1.6,-1.483,-1.2])*25.0
Yvrt[4,0:nvrt[4]+3]=asarray([0.0,0.283,0.4,0.461,0.635,0.894,1.2,1.483,1.6,1.483,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-1.14,-0.751,-0.5,-0.4,-0.283,0.0,0.283,0.4])*25.0

Xvrt[5,0:nvrt[5]+3]=asarray([-1.6,-0.988,-0.468,-0.122,0.0,0.1,0.351,0.74,1.2,1.483,1.6,1.131,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-0.988,-0.468])*25.0
Yvrt[5,0:nvrt[5]+3]=asarray([0.0,-0.122,-0.468,-0.988,-1.6,-1.14,-0.751,-0.5,-0.4,-0.283,0.0,1.131,1.6,1.483,1.2,0.74,0.351,0.1,0.0,-0.122,-0.468])*25.0

Xvrt[6,0:nvrt[6]+3]=asarray([-1.6,-0.988,-0.468,-0.122,0.0,1.131,1.6,1.483,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-0.988,-0.468])*25.0
Yvrt[6,0:nvrt[6]+3]=asarray([0.0,0.122,0.468,0.988,1.6,1.131,0.0,-0.283,-0.4,-0.461,-0.635,-0.894,-1.2,-1.483,-1.6,-1.483,-1.2,-0.74,-0.351,-0.1,0.0,0.122,0.468])*25.0

Xvrt[7,0:nvrt[7]+3] = asarray([-0.294,-0.075,0.0,0.075,0.294,0.651,1.131,0.612,0.0,-0.612,-1.131,-0.651,-0.294,-0.075,0.0])*25.0
Yvrt[7,0:nvrt[7]+3] = asarray([0.122,0.846,1.6,0.846,0.122,-0.546,-1.131,-0.785,-0.663,-0.785,-1.131,-0.546,0.122,0.846,1.6])*25.0

Xvrt[8,0:nvrt[8]+3] = asarray([-0.467,-0.35,-0.393,-0.283,0.0,0.283,0.393,0.35,0.467,0.751,1.131,0.612,0.0,-0.612,-1.131,-0.751,-0.467,-0.35,-0.393])*25.0 
Yvrt[8,0:nvrt[8]+3] = asarray([0.102,0.505,1.122,1.483,1.6,1.483,1.122,0.505,-0.102,-0.688,-1.131,-0.785,-0.663,-0.785,-1.131,-0.688,0.102,0.505,1.122])*25.0

Xvrt[9,0:nvrt[9]+3] =asarray([-0.294,-0.075,0.0,0.054,0.257,0.605,1.071,1.248,1.131,0.85,0.57,0.179,-0.282,-0.742,-1.131,-0.651,-0.294,-0.075,0.0])*25.0
Yvrt[9,0:nvrt[9]+3] =asarray([0.122,0.846,1.6,0.983,0.401,-0.111,-0.516,-0.848,-1.131,-1.25,-1.131,-0.871,-0.78,-0.871,-1.131,-0.546,0.122,0.846,1.6])*25.0

Xvrt[10,0:nvrt[10]+3] =asarray([-0.257,-0.054,0.0,0.075,0.294,0.651,1.131,0.742,0.282,-0.179,-0.571,-0.85,-1.131,-1.248,-1.071,-0.605,-0.257,-0.054,0.0])*25.0
Yvrt[10,0:nvrt[10]+3] =asarray([0.401,0.983,1.6,0.846,0.122,-0.546,-1.131,-0.871,-0.78,-0.871,-1.131,-1.25,-1.131,-0.848,-0.516,-0.111,0.401,0.983,1.6])*25.0

Xvrt[11,0:nvrt[11]+3]=asarray([-0.257,-0.054,0.0,0.054,0.257,0.605,1.071,1.248,1.131,0.85,0.57,0.308,0.0,-0.308,-0.57,-0.85,-1.131,-1.248,-1.071,-0.605,-0.257,-0.054,0.0])*25.0
Yvrt[11,0:nvrt[11]+3]=asarray([0.401,0.983,1.6,0.983,0.401,-0.111,-0.516,-0.848,-1.131,-1.25,-1.131,-0.957,-0.896,-0.957,-1.131,-1.25,-1.131,-0.848,-0.516,-0.111,0.401,0.983,1.6])*25.0

Xvrt[12,0:nvrt[12]+3]=asarray([-0.487,-0.373,-0.393,-0.283,0.0,0.283,0.393,0.35,0.467,0.751,1.131,0.742,0.282,-0.179,-0.571,-0.85,-1.131,-1.248,-1.071,-0.727,-0.487,-0.373,-0.393])*25.0
Yvrt[12,0:nvrt[12]+3]=asarray([0.198,0.652,1.122,1.483,1.6,1.483,1.122,0.505,-0.102,-0.688,-1.131,-0.871,-0.78,-0.871,-1.131,-1.25,-1.131,-0.848,-0.516,-0.203,0.198,0.652,1.122])*25.0

Xvrt[13,0:nvrt[13]+3]=asarray([-0.467,-0.35,-0.393,-0.283,0.0,0.283,0.393,0.373,0.487,0.727,1.071,1.248,1.131,0.85,0.57,0.179,-0.282,-0.742,-1.131,-0.751,-0.467,-0.35,-0.393])*25.0
Yvrt[13,0:nvrt[13]+3]=asarray([0.102,0.505,1.122,1.483,1.6,1.483,1.122,0.652,0.198,-0.203,-0.516,-0.848,-1.131,-1.25,-1.131,-0.871,-0.78,-0.871,-1.131,-0.688,0.102,0.505,1.122])*25.0

Xvrt[14,0:nvrt[14]+3]=asarray([-0.487,-0.373,-0.393,-0.283,0.0,0.283,0.393,0.373,0.487,0.727,1.071,1.248,1.131,0.85,0.57,0.308,0.0,-0.308,-0.57,-0.85,-1.131,-1.248,-1.071,-0.727,-0.487,-0.373,-0.393])*25.0
Yvrt[14,0:nvrt[14]+3]=asarray([0.198,0.652,1.122,1.483,1.6,1.483,1.122,0.652,0.198,-0.203,-0.516,-0.848,-1.131,-1.25,-1.131,-0.957,-0.896,-0.957,-1.131,-1.25,-1.131,-0.848,-0.516,-0.203,0.198,0.652,1.122])*25.0

Xvrt[15,0:nvrt[15]+3]=asarray([-0.257,-0.054,0.0,0.054,0.257,0.605,1.071,1.248,1.131,0.85,0.0,-0.85,-1.131,-1.248,-1.071,-0.605,-0.257,-0.054,0.0])*25.0
Yvrt[15,0:nvrt[15]+3]=asarray([0.401,0.983,1.6,0.983,0.401,-0.111,-0.516,-0.848,-1.131,-1.25,-1.6,-1.25,-1.131,-0.848,-0.516,-0.111,0.401,0.983,1.6])*25.0

Xvrt[16,0:nvrt[16]+3]=asarray([-0.467,-0.35,-0.393,-0.283,0.0,0.283,1.031,1.248,1.131,0.85,0.57,0.179,-0.282,-0.742,-1.131,-0.751,-0.467,-0.35,-0.393])*25.0
Yvrt[16,0:nvrt[16]+3]=asarray([0.102,0.505,1.122,1.483,1.6,1.483,0.298,-0.848,-1.131,-1.25,-1.131,-0.871,-0.78,-0.871,-1.131,-0.688,0.102,0.505,1.122])*25.0

Xvrt[17,0:nvrt[17]+3]=asarray([0.467,0.35,0.393,0.283,0.0,-0.283,-1.031,-1.248,-1.131,-0.85,-0.57,-0.179,0.282,0.742,1.131,0.751,0.467,0.35,0.393])*25.0
Yvrt[17,0:nvrt[17]+3]=asarray([0.102,0.505,1.122,1.483,1.6,1.483,0.298,-0.848,-1.131,-1.25,-1.131,-0.871,-0.78,-0.871,-1.131,-0.688,0.102,0.505,1.122])*25.0

Xvrt[18,0:nvrt[18]+3]=asarray([-0.487,-0.373,-0.393,-0.283,0.0,0.283,1.031,1.248,1.131,0.85,0.57,0.308,0.0,-0.308,-0.57,-0.85,-1.131,-1.248,-1.071,-0.727,-0.487,-0.373,-0.393])*25.0
Yvrt[18,0:nvrt[18]+3]=asarray([0.198,0.652,1.122,1.483,1.6,1.483,0.298,-0.848,-1.131,-1.25,-1.131,-0.957,-0.896,-0.957,-1.131,-1.25,-1.131,-0.848,-0.516,-0.203,0.198,0.652,1.122])*25.0

Xvrt[19,0:nvrt[19]+3]=asarray([0.487,0.373,0.393,0.283,0.0,-0.283,-1.031,-1.248,-1.131,-0.85,-0.57,-0.308,0.0,0.308,0.57,0.85,1.131,1.248,1.071,0.727,0.487,0.373,0.393])*25.0
Yvrt[19,0:nvrt[19]+3]=asarray([0.198,0.652,1.122,1.483,1.6,1.483,0.298,-0.848,-1.131,-1.25,-1.131,-0.957,-0.896,-0.957,-1.131,-1.25,-1.131,-0.848,-0.516,-0.203,0.198,0.652,1.122])*25.0

Xvrt[20,0:nvrt[20]+3]=asarray([-0.487,-0.373,-0.393,-0.283,0.0,0.283,0.393,0.373,0.487,0.727,1.071,1.248,1.131,0.85,0.0,-0.85,-1.131,-1.248,-1.071,-0.727,-0.487,-0.373,-0.393])*25.0
Yvrt[20,0:nvrt[20]+3]=asarray([0.198,0.652,1.122,1.483,1.6,1.483,1.122,0.652,0.198,-0.203,-0.516,-0.848,-1.131,-1.25,-1.6,-1.25,-1.131,-0.848,-0.516,-0.203,0.198,0.652,1.122])*25.0

Xvrt[21,0:nvrt[21]+3]=asarray([-0.571,-0.369,0.0,0.283,0.4,0.492,0.752,1.14,1.6,0.988,0.468,0.122,0.0,-0.212,-0.381,-0.575,-0.571,-0.369,0.0])*25.0
Yvrt[21,0:nvrt[21]+3]=asarray([0.605,1.354,1.6,1.483,1.2,0.74,0.352,0.092,0.0,-0.122,-0.468,-0.988,-1.6,-1.273,-0.923,-0.172,0.605,1.354,1.6])*25.0

Xvrt[22,0:nvrt[22]+3]=asarray([-0.533,-0.397,-0.176,0.0,0.122,0.468,0.988,1.6,0.988,0.468,0.122,0.0,-0.176,-0.397,-0.533,-0.397,-0.176])*25.0
Yvrt[22,0:nvrt[22]+3]=asarray([0.0,0.843,1.333,1.6,0.988,0.468,0.122,0.0,-0.122,-0.468,-0.988,-1.6,-1.333,-0.843,0.0,0.843,1.333])*25.0

Xvrt[23,0:nvrt[23]+3]=asarray([-0.533,-0.397,-0.176,0.0,0.1,0.351,0.74,1.2,1.483,1.6,1.483,1.2,0.74,0.351,0.1,0.0,-0.176,-0.397,-0.533,-0.397,-0.176])*25.0
Yvrt[23,0:nvrt[23]+3]=asarray([0.0,0.843,1.333,1.6,1.14,0.751,0.5,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-1.333,-0.843,0.0,0.843,1.333])*25.0

Xvrt[24,0:nvrt[24]+3]=asarray([-0.575,-0.381,-0.212,0.0,0.122,0.468,0.988,1.6,1.14,0.752,0.492,0.4,0.283,0.0,-0.369,-0.571,-0.575,-0.381,-0.212])*25.0
Yvrt[24,0:nvrt[24]+3]=asarray([0.172,0.923,1.273,1.6,0.988,0.468,0.122,0.0,-0.092,-0.352,-0.74,-1.2,-1.483,-1.6,-1.354,-0.605,0.172,0.923,1.273])*25.0

Xvrt[25,0:nvrt[25]+3]=asarray([-0.571,-0.369,0.0,0.283,0.4,0.461,0.635,0.894,1.2,1.483,1.6,1.483,1.2,0.74,0.351,0.1,0.0,-0.212,-0.381,-0.575,-0.571,-0.369,0.0])*25.0
Yvrt[25,0:nvrt[25]+3]=asarray([0.605,1.354,1.6,1.483,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.283,-0.4,-0.5,-0.751,-1.14,-1.6,-1.273,-0.923,-0.172,0.605,1.354,1.6])*25.0

Xvrt[26,0:nvrt[26]+3]=asarray([-0.64,-0.571,-0.369,0.0,0.283,0.4,0.492,0.752,1.14,1.6,1.14,0.752,0.492,0.4,0.283,0.0,-0.369,-0.571,-0.64,-0.571,-0.369])*25.0
Yvrt[26,0:nvrt[26]+3]=asarray([0.0,0.689,1.354,1.6,1.483,1.2,0.74,0.352,0.092,0.0,-0.092,-0.352,-0.74,-1.2,-1.483,-1.6,-1.354,-0.689,0.0,0.689,1.354])*25.0

Xvrt[27,0:nvrt[27]+3]=asarray([-0.64,-0.571,-0.369,0.0,0.283,0.4,0.461,0.635,0.894,1.2,1.483,1.6,1.483,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.369,-0.571,-0.64,-0.571,-0.369])*25.0
Yvrt[27,0:nvrt[27]+3]=asarray([0.0,0.689,1.354,1.6,1.483,1.2,0.894,0.635,0.461,0.42,0.283,0.0,-0.283,-0.4,-0.461,-0.635,-0.894,-1.2,-1.483,-1.6,-1.354,-0.689,0.0,0.689,1.354])*25.0

Xvrt[28,0:nvrt[28]+3]=asarray([-1.6,-1.131,0.0,1.131,1.6,1.2,0.74,0.351,0.1,0.0,-0.1,-0.351,-0.74,-1.2,-1.6,-1.131,0.0])*25.0
Yvrt[28,0:nvrt[28]+3]=asarray([0.0,1.131,1.6,1.131,0.0,-0.4,-0.5,-0.751,-1.14,-1.6,-1.14,-0.751,-0.5,-0.4,0.0,1.131,1.6])*25.0

Xvrt[29,0:nvrt[29]+3]=asarray([-0.571,0.0,1.131,1.6,1.2,0.74,0.351,0.1,0.0,-0.212,-0.381,-0.575,-0.571,0.0,1.131])*25.0
Yvrt[29,0:nvrt[29]+3]=asarray([0.605,1.6,1.131,0.0,-0.4,-0.5,-0.751,-1.14,-1.6,-1.273,-0.923,-0.172,0.605,1.6,1.131])*25.0

Xvrt[30,0:nvrt[30]+3]=asarray([0.575,0.381,0.212,0.0,-0.1,-0.351,-0.74,-1.2,-1.6,-1.131,0.0,0.571,0.575,0.381,0.212])*25.0
Yvrt[30,0:nvrt[30]+3]=asarray([-0.172,-0.923,-1.273,-1.6,-1.14,-0.751,-0.5,-0.4,0.0,1.131,1.6,0.605,-0.172,-0.923,-1.273])*25.0

Xvrt[31,0:nvrt[31]+3]=asarray([-0.64,-0.571,0.0,1.131,1.6,1.2,0.894,0.635,0.461,0.4,0.283,0.0,-0.369,-0.571,-0.64,-0.571,0.0])*25.0
Yvrt[31,0:nvrt[31]+3]=asarray([0.0,0.689,1.6,1.131,0.0,-0.4,-0.461,-0.635,-0.894,-1.2,-1.483,-1.6,-1.354,-0.689,0.0,0.689,1.6])*25.0

Xvrt[32,0:nvrt[32]+3]=asarray([0.64,0.571,0.369,0.0,-0.283,-0.4,-0.461,-0.635,-0.894,-1.2,-1.6,-1.131,0.0,0.571,0.64,0.571,0.369])*25.0
Yvrt[32,0:nvrt[32]+3]=asarray([0.0,-0.689,-1.354,-1.6,-1.483,-1.2,-0.894,-0.635,-0.461,-0.4,0.0,1.131,1.6,0.689,0.0,-0.689,-1.354])*25.0

Xvrt[33,0:nvrt[33]+3]=asarray([-1.6,-1.2,-0.894,-0.635,-0.461,-0.4,0.0,1.131,1.6,1.131,0.0,-1.131,-1.6,-1.2,-0.894])*25.0
Yvrt[33,0:nvrt[33]+3]=asarray([0.0,-0.4,-0.461,-0.635,-0.894,-1.2,-1.6,-1.131,0.0,1.131,1.6,1.131,0.0,-0.4,-0.461])*25.0

Xvrt[34,0:nvrt[34]+3]=asarray([-1.6,-1.2,-0.894,-0.635,-0.461,-0.4,-0.283,0.0,0.283,0.4,0.461,0.635,0.894,1.2,1.6,1.131,0.0,-1.131,-1.6,-1.2,-0.894])*25.0
Yvrt[34,0:nvrt[34]+3]=asarray([0.0,-0.4,-0.461,-0.635,-0.894,-1.2,-1.483,-1.6,-1.483,-1.2,-0.894,-0.635,-0.461,-0.4,0.0,1.131,1.6,1.131,0.0,-0.4,-0.461])*25.0

i = 0

ip = arange(50)/50.0 ### sampling
incr = zeros((4,50), Float)
incr[0,:] = -ip*ip*ip+3*ip*ip-3*ip+1
incr[1,:] = 3*ip*ip*ip-6*ip*ip+4
incr[2,:] = -3*ip*ip*ip+3*ip*ip+3*ip+1
incr[3,:] = ip*ip*ip
Xarr = zeros((numstims,max(nvrt)*50), Float)## array for polygon vertices
Yarr = zeros((numstims,max(nvrt)*50), Float)
xvrtid = zeros((4,50), Float)
yvrtid = zeros((4,50), Float)
while i < numstims:
    vtx = []
    vty = []
	j = 0
    while j < nvrt[i]:
        k=0
        while k < 4:
            xvrtid[k,:] = Xvrt[i,j+k]
            yvrtid[k,:] = Yvrt[i,j+k]
            k = k+1
        xb = list(sum(xvrtid*incr)/6.0)
        vtx.append(xb)
        yb = list(sum(yvrtid*incr)/6.0)
        vty.append(yb)
        j = j+1
    vtx1 = reshape(array(vtx),(nvrt[i]*50,))
    vty1 = reshape(array(vty),(nvrt[i]*50,))
    
    Xarr[i,0:nvrt[i]*50] = vtx1
    Yarr[i,0:nvrt[i]*50] = vty1
    i = i+1



